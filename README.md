# Théoden Chatbot  
A PyTorch-based neural network chatbot that speaks in the voice of Théoden, King of Rohan. Features real-time weather lookup styled in the manner of the Riddermark.

## Overview  
This project implements an intent-classification chatbot using a small feed-forward neural network trained on patterns from `intents.json`. The bot is themed around Théoden from The Lord of the Rings and responds in archaic, Rohirric English. A special “weather” intent fetches live weather data via public APIs and returns it in the same epic style.

## File Structure
```
.
├── intents.json          # Training data and bot responses (Théoden-themed)
├── train.py              # Training script (processes intents → trains → saves data.pth)
├── model.py              # NeuralNet class definition
├── nltk_utils.py         # Tokenization, stemming, bag-of-words functions
├── weather_utils.py      # Real-time weather fetching (Open-Meteo + Nominatim)
├── chat.py               # Main inference script (interactive chat)
├── data.pth              # Saved model state, vocabulary, and tags (generated by train.py)
└── README.md
```

## Requirements
- Python 3.8+
- torch
- numpy
- nltk
- requests
-scikit-learn

Install with:
```bash
pip install torch numpy nltk requests
python -c "import nltk; nltk.download('punkt')"
```

## Training
1. Place or edit `intents.json` with your patterns and responses.
2. Run the training script:
```bash
python train.py
```
This will create `data.pth` containing the trained model and vocabulary.

## Running the Chatbot(GUI)
```bash
python app.py
```

## Running the Chatbot(Terminal)
```bash
python chat.py
```
- Type normally (“hi”, “how’s the weather”, “bye”, etc.).
- When the weather intent is detected, the bot will ask for a city name and return live conditions.
- Type `quit` (or any farewell) to exit.

## Weather Integration
- Uses Open-Meteo (no API key required) for current weather.
- Uses Nominatim (OpenStreetMap) for geocoding city names.
- All responses are delivered in Théoden’s voice, e.g.:  
  `"In Paris, the air stands at 50°F (10°C), wind 15 km/h from the 220° quarter. The sky is partly clouded, shadows drift across the plains."`

## Customization
- Add or modify entries in `intents.json` and retrain with `train.py`.
- Adjust confidence threshold (currently 0.75) in `chat.py`.
- Extend `weather_utils.py` for forecasts or additional data if desired.

## Notes
- The model is deliberately lightweight for quick training and inference on CPU.
- No external paid APIs are required.
- All network requests include a polite User-Agent header.

# Forth, and fear no darkness!

![Théoden at Helms Deep](assets/Theoden_at_helms_deep.jpg)